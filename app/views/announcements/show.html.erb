<div class="container mx-auto p-4">
  <h1 class="text-3xl font-bold"><%= @announcement.title %></h1>
  <p class="text-gray-600 mt-2"><%= @announcement.description %></p>
  <p class="text-lg font-semibold mt-2"><%= number_to_currency(@announcement.price, unit: "R$") %></p>
  <p class="text-gray-500">Por: <%= @announcement.user.name %></p>
  <p class="text-gray-500"><%= @announcement.user.address.city %>, <%= @announcement.user.address.state %></p>

  <!-- Imagens -->
  <%= render "show_images" %>

  <!-- Botões de Edição e Exclusão (apenas para o dono) -->
  <% if user_signed_in? && @announcement.user == current_user %>
    <div class="mt-4 flex gap-2">
      <%= link_to "Editar Anúncio", edit_announcement_path(@announcement), class: "bg-yellow-500 text-white p-2 rounded hover:bg-yellow-600" %>
      <%= button_to "Excluir Anúncio", announcement_path(@announcement), 
          method: :delete, data: { turbo_confirm: "Tem certeza que deseja excluir este anúncio?", turbo_frame: "_top" }, 
          class: "bg-red-500 text-white p-2 rounded hover:bg-red-600" 
      %>
    </div>
  <% end %>

  <!-- Curtidas -->
  <%= render "likes" %>

  <!-- Comentários -->
  <%= render "comments" %>

  <!-- Link para voltar -->
  <div class="mt-4">
    <% if session[:last_search_params].present? %>
      <%= link_to "Voltar para a lista", announcements_path + "?" + session[:last_search_params], class: "text-blue-500 hover:underline" %>
    <% else %>
      <%= link_to "Voltar para a lista", announcements_path, class: "text-blue-500 hover:underline" %>
    <% end %>
  </div>
</div>

<!-- Modal de Imagens -->
<div id="imageModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden" data-controller="image-modal">
  <div class="flex items-center justify-center h-full relative">
    <!-- Botão Fechar -->
    <button class="absolute top-4 right-4 text-white text-4xl hover:text-gray-300 z-10" data-action="click->image-modal#closeModal">
      &times;
    </button>
    
    <!-- Botão Anterior -->
    <% if @announcement.images.count > 1 %>
      <button class="absolute left-4 text-white text-4xl hover:text-gray-300 z-10" data-action="click->image-modal#previousImage">
        &#8249;
      </button>
    <% end %>
    
    <!-- Imagem Principal -->
    <div class="max-w-4xl max-h-full p-4">
      <img id="modalImage" src="" alt="Imagem do anúncio" class="max-w-full max-h-full object-contain">
    </div>
    
    <!-- Botão Próximo -->
    <% if @announcement.images.count > 1 %>
      <button class="absolute right-4 text-white text-4xl hover:text-gray-300 z-10" data-action="click->image-modal#nextImage">
        &#8250;
      </button>
    <% end %>
    
    <!-- Contador de Imagens -->
    <% if @announcement.images.count > 1 %>
      <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-lg">
        <span id="imageCounter">1</span> / <%= @announcement.images.count %>
      </div>
    <% end %>
  </div>
</div>
