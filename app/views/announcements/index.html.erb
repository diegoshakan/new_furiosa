<div class="container mx-auto p-4">
  <h1 class="text-3xl font-bold mb-4">Anúncios de Festas - Furiosa</h1>

  <!-- Filtros e Pesquisa -->
  <%= form_with url: announcements_path, method: :get, data: { turbo_frame: "announcements" } do |f| %>
    <div class="flex flex-wrap gap-4 mb-4">
      <%= f.text_field :search, placeholder: "Pesquisar...", class: "border p-2 rounded" %>
      <%= f.select :category_id, Category.all.map { |c| [c.name, c.id] }, { include_blank: "Categoria" }, class: "border p-2 rounded" %>
      <%= f.text_field :city, placeholder: "Cidade", class: "border p-2 rounded" %>
      <%= f.text_field :state, placeholder: "Estado", class: "border p-2 rounded" %>
      <%= f.submit "Filtrar", class: "bg-blue-500 text-white p-2 rounded hover:bg-blue-600" %>
    </div>
  <% end %>

  <!-- Lista de Anúncios -->
  <%= turbo_frame_tag "announcements" do %>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <% @announcements.each do |announcement| %>
        <div class="border p-4 rounded shadow hover:shadow-lg">
          <% if announcement.images.attached? %>
            <%= image_tag announcement.images.first, class: "w-full h-48 object-cover rounded mb-2" %>
          <% else %>
            <div class="w-full h-48 bg-gray-200 flex items-center justify-center rounded mb-2">
              <span class="text-gray-500">Sem imagem</span>
            </div>
          <% end %>
          <h2 class="text-xl font-semibold"><%= announcement.title %></h2>
          <p class="text-gray-600"><%= number_to_currency(announcement.price, unit: "R$") %></p>
          <p class="text-gray-500">Por: <%= announcement.user.name %></p>
          <%= link_to "Ver Detalhes", announcement_path(announcement), class: "text-blue-500 hover:underline", data: { turbo_frame: "_top" } %>
        </div>
      <% end %>
    </div>
  <% end %>

  <!-- Botão para criar novo anúncio (somente para usuários logados) -->
  <% if user_signed_in? %>
    <div class="mt-4">
      <%= link_to "Criar Novo Anúncio", new_announcement_path, class: "bg-green-500 text-white p-2 rounded hover:bg-green-600" %>
    </div>
  <% end %>
</div>